#include "Dot_Matrix.h"

const unsigned char ziku_table[]={
	
0xFF,0xF7,0x80,0xF5,0xEB,0xF5,0xEB,0xC1,0x80,0xF5,0xAA,0xF6,0xAA,0xF7,0xAA,0x80,
0x8A,0xFF,0xBC,0xFF,0xBE,0xC1,0x80,0xDD,0xBE,0xDD,0xBE,0xDD,0x80,0xC1,0xBE,0xDD,/*"?",0*/

0xFF,0xFF,0xFB,0x7F,0x1B,0x7E,0xDB,0x7E,0xDB,0xBE,0xDB,0xBE,0x00,0xD0,0xDB,0xEE,
0xDB,0xD6,0xDB,0xBA,0x1B,0x7E,0xFB,0x7F,0xF8,0xFF,0x07,0x00,0x9F,0xFF,0x7F,0xFF,/*"?",2*/

0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x01,0x80,0xDD,0x7D,0xDD,0xBD,0xDD,0xFD,0xDD,0xFD,
0x01,0x80,0xDD,0xFD,0xDD,0xFD,0xDD,0xFD,0xDD,0xFD,0x01,0xE0,0xFF,0x9F,0xFF,0x7F,/*"?",3*/

0xFF,0xFF,0xC7,0xE3,0xF7,0xDD,0xF7,0xDE,0xF7,0xDE,0x77,0xDF,0x8F,0xC7,0xFF,0xFF,/*"S",4*/

0xFF,0xFF,0xE7,0xFF,0xF7,0xFF,0xF7,0xDF,0x07,0xC0,0xF7,0xDF,0xF7,0xFF,0xE7,0xFF,/*"T",5*/

0xFF,0xFF,0xF7,0xDF,0x07,0xC0,0x07,0xFF,0xFF,0xC0,0x07,0xFF,0x07,0xC0,0xF7,0xDF,/*"M",6*/

0xFF,0xFF,0xCF,0xF1,0xB7,0xEE,0x77,0xDF,0x77,0xDF,0xF7,0xDF,0xCF,0xE7,0xFF,0xFF,/*"3",7*/

0xFF,0xFF,0x8F,0xCF,0x77,0xDE,0xF7,0xDD,0xF7,0xDB,0xF7,0xD7,0x8F,0xCF,0xFF,0xFF,/*"2",8*/

0xFF,0xFF,0xEF,0xFF,0xF7,0xFF,0x17,0xFC,0x77,0xFF,0x77,0xDF,0x07,0xC0,0xF7,0xDF,/*"F",9*/

0xFF,0xFF,0xFF,0xDB,0x07,0xC0,0xEF,0xDB,0xDF,0xDB,0x3F,0xFB,0xFF,0xF8,0xFF,0xFF,/*"4",10*/

0xFF,0xFF,0x1F,0xF0,0xEF,0xEF,0xF7,0xDF,0xF7,0xDF,0xEF,0xEF,0x1F,0xF0,0xFF,0xFF,/*"0",11*/

0xFF,0xFF,0xF7,0xFF,0xC7,0xFF,0x37,0xFF,0xF7,0xC0,0xF7,0xFF,0xC7,0xFF,0xFF,0xFF,/*"7",12*/

0xFF,0xFF,0x3F,0x7F,0xBF,0xBE,0xB1,0xCF,0xB7,0xF0,0x87,0xCF,0x77,0xBF,0xF7,0x7E,
0x70,0xFF,0x17,0x80,0x77,0xDB,0x77,0xDB,0x77,0xDB,0x11,0x80,0x7F,0xFF,0x7F,0xFF,/*"?",13*/

0xFF,0xFF,0xFF,0x7F,0xFF,0x7F,0xFF,0xBF,0xFF,0xCF,0xFF,0xF3,0xFF,0xFC,0x1F,0xFF,
0xE3,0xFF,0x1D,0xFF,0xFE,0xFC,0xFF,0xF3,0xFF,0xEF,0xFF,0xDF,0xFF,0xBF,0xFF,0x7F,/*"?",14*/

0xFF,0xFF,0xEF,0x07,0xE9,0xBF,0xEE,0xDF,0xEF,0xEF,0xEF,0xF3,0x00,0xFC,0xEF,0xFF,
0xEF,0xEF,0x6F,0xEF,0x6F,0xEF,0x6F,0xC0,0x6F,0xDF,0x6F,0x9F,0xEF,0xDF,0xEF,0xFF,/*"?",15*/

0xFF,0xFF,0x7F,0xFF,0x7D,0xFF,0x7D,0xFF,0x7D,0xFF,0x01,0x00,0x7D,0xFF,0x7D,0xFF,
0x7D,0xFF,0x7D,0xFF,0x7D,0xFF,0x01,0xF0,0x7D,0xCF,0x7D,0xBF,0x7D,0x7F,0x7F,0xFF,/*"?",16*/

0xFF,0xFF,0xFF,0x7F,0xEF,0x7F,0x6B,0xBC,0x6D,0xBB,0x6F,0xD7,0x6F,0xEF,0x6F,0xD7,
0x68,0xB9,0x47,0xBE,0x2F,0x7F,0xEF,0x7C,0xE9,0x73,0xE7,0xEF,0xFF,0xDF,0xFF,0xFF,/*"?",17*/

0xFF,0xFF,0xFF,0xFE,0xFD,0xFE,0xFD,0xFE,0xCD,0xFE,0xBD,0xFE,0xFD,0xFE,0xFD,0xFE,
0x01,0x00,0xFD,0xFE,0xFD,0xFE,0x9D,0xFE,0xED,0xFE,0xFD,0xFE,0xFD,0xFE,0xFF,0xFE,/*"?",18*/

0xFF,0xFF,0xFF,0xFF,0x3F,0xFF,0x9F,0xFF,0xAF,0x01,0xB7,0xBD,0xBF,0xBD,0xBF,0xBD,
0xBF,0xBD,0xBC,0xBD,0xBB,0xBD,0xB7,0xBD,0xAF,0x01,0x1F,0xFF,0xBF,0xFF,0xFF,0xFF,/*"?",19*/
};

static u8 read_value_dot = 0;

void ABCD_port(u8 dat)
{
	if((dat&0x01)==0x00)		
		{
		   //A_ONOFF(Bit_RESET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(~(1 << 5)) & read_value_dot);
		}
	else 
		{
			//A_ONOFF(Bit_SET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(1 << 5) | read_value_dot);
		}
	if((dat&0x02)==0x00)
	{
			//B_ONOFF(Bit_RESET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(~(1 << 7)) & read_value_dot);	
	}
	else 
	{
		//B_ONOFF(Bit_SET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(1 << 7) | read_value_dot);
	}
	if((dat&0x04)==0x00)
	{
		//C_ONOFF(Bit_RESET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(~(1 << 0)) & read_value_dot);		
	}
	else 
	{
	//C_ONOFF(Bit_SET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(1 << 0) | read_value_dot);		
	}
	if((dat&0x08)==0x00)
	{
		//D_ONOFF(Bit_RESET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(~(1 << 4)) & read_value_dot);	
	}
	else 
	{
	//D_ONOFF(Bit_SET);
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(1 << 4) | read_value_dot);
	}
}

void Dot_Matrix_test(void)
{
	
	u8  i,j;
	//u8 i;
	u8 data_buff;
	u8 hanzi;
//	u8 han;
	u8 shift=1;	
	
	//PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,0);
	//PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,0);
			
	for(shift=0;shift<16;shift++){	

			//LAT_ONOFF(Bit_RESET);			  	//PG3
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(~(1 << 3)) & read_value_dot);

			//DCLK_ONOFF(Bit_RESET);				//PG1
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(~(1 << 1)) & read_value_dot);

			//74HC595那?3?那y?YHzk16
			data_buff = ziku_table[hanzi*32+shift*2+1];
			for(i=0;i<8;i++){
				if((data_buff&0x80)!=0) 
				{
					//DI_ONOFF(Bit_SET);//DA_in_port = 1;	 	PF2
			   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   			PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(1 << 2) | read_value_dot);			
				}
				else 
				{
					//DI_ONOFF(Bit_RESET);//DA_in_port = 0;
					read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   			PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(~(1 << 2)) & read_value_dot);
				}
				//DCLK_ONOFF(Bit_SET);//CLK_port = 1;								PG1
 		   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   		PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(1 << 1) | read_value_dot);
				
				//DCLK_ONOFF(Bit_RESET);//CLK_port = 0;							PG1
 		   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   		PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(~(1 << 1)) & read_value_dot);
				data_buff <<= 1;
				}
				data_buff = ziku_table[hanzi*32+shift*2];
				for(i=0;i<8;i++)
				{
				if((data_buff&0x01)!=0) 
				{
					//DI_ONOFF(Bit_SET);//DA_in_port = 1;
			   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   			PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(1 << 2) | read_value_dot);						
				}
				else 
				{
					//DI_ONOFF(Bit_RESET);//DA_in_port = 0;
					read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   			PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(~(1 << 2)) & read_value_dot);				
				}
				//DCLK_ONOFF(Bit_SET);//CLK_port = 1;
 		   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   		PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(1 << 1) | read_value_dot);

				//DCLK_ONOFF(Bit_RESET);//CLK_port = 0;
 		   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   		PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(~(1 << 1)) & read_value_dot);

				data_buff >>= 1;
				}
 
			//G_ONOFF(Bit_SET);//EN_port = 1;    									 PF0
 		   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   		PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(1 << 0) | read_value_dot);
			
			ABCD_port(shift);//ABCD_port = (ABCD_port & 0x0f)|(han<<4);  //HC138辰???那?3?
			//ABCD_port(han);//ABCD_port = (ABCD_port & 0x0f)|(han<<4);  //HC138辰???那?3?

			//LAT_ONOFF(Bit_SET);//Latch_port = 1; //?那D赤HC595那y?Y那?3?米?Q1-Q8???迆
		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(1 << 3) | read_value_dot);

			//G_ONOFF(Bit_RESET);//EN_port = 0;    //HC138那?3?車DD∫㏒?∩辰?a??那?
 		   		read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   		PCF8574_Single_WriteI2C(UF_PCF8574_SlaveAddress,(~(1 << 0)) & read_value_dot);


			//LAT_ONOFF(Bit_RESET);//Latch_port = 0;	//???“HC595那y?Y那?3?
 		   read_value_dot = PCF8574_Single_ReadI2C(UF_PCF8574_SlaveAddress);
		   PCF8574_Single_WriteI2C(UG_PCF8574_SlaveAddress,(~(1 << 3)) & read_value_dot);
	}
	
}
	
